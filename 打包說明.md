# 打包成獨立執行檔說明

## 🎯 問題

同事的電腦可能沒有：
- ❌ Python
- ❌ pymodbus 套件
- ❌ tkinter（通常內建，但有時會缺少）

## ✅ 解決方案：打包成 EXE

使用 PyInstaller 將程式打包成獨立的 .exe 檔案，包含所有依賴。

---

## 🚀 方式 1: 使用自動腳本（推薦）

### 步驟

1. **執行打包腳本**
   ```
   雙擊「打包成EXE.bat」
   ```

2. **等待完成**（約 2-5 分鐘）
   - 會自動安裝 PyInstaller
   - 打包程式
   - 建立發布資料夾
   - 壓縮成 ZIP

3. **取得檔案**
   ```
   TMflow_Modbus_Testkit_Portable_v1.0.1.0001.zip
   ```

### 優點
- ✅ 完全自動化
- ✅ 包含所有依賴
- ✅ 同事不需要安裝任何東西

---

## 🔧 方式 2: 手動打包

### 步驟

1. **安裝 PyInstaller**
   ```bash
   pip install pyinstaller
   ```

2. **打包程式**
   ```bash
   pyinstaller --onefile --windowed --name "TMflow_Modbus_Testkit" tmflow_modbus_testkit.py
   ```

3. **找到 EXE**
   ```
   dist/TMflow_Modbus_Testkit.exe
   ```

### 參數說明
- `--onefile`: 打包成單一 EXE 檔案
- `--windowed`: 不顯示終端機視窗（GUI 程式）
- `--name`: 指定 EXE 檔案名稱

---

## 📦 打包後的檔案結構

```
TMflow_Modbus_Testkit_Portable_v1.0.1.0001/
├── TMflow_Modbus_Testkit.exe    # 主程式（15-20 MB）
├── 使用說明.txt                  # 使用指南
├── 功能說明.txt                  # 功能說明
└── 開始使用.txt                  # 快速開始
```

---

## 📊 檔案大小比較

| 版本 | 大小 | 需要 Python | 需要套件 |
|------|------|------------|---------|
| 原始碼版 | 50 KB | ✅ 需要 | ✅ 需要 |
| EXE 版 | 15-20 MB | ❌ 不需要 | ❌ 不需要 |

---

## 🎯 給同事的使用說明

### EXE 版本（推薦給同事）

```
【TMflow Modbus 測試工具 - 免安裝版】

使用步驟：
1. 解壓縮 ZIP 檔案
2. 雙擊「TMflow_Modbus_Testkit.exe」
3. 輸入 TMflow IP 和 Port
4. 點擊連線

完全不需要安裝 Python 或任何套件！
```

### 原始碼版本（給開發者）

```
【TMflow Modbus 測試工具 - 原始碼版】

使用步驟：
1. 安裝 Python 3.7+
2. 執行 pip install -r requirements.txt
3. 雙擊「啟動測試工具.bat」

適合需要修改程式碼的使用者
```

---

## ⚠️ 注意事項

### 打包時間
- 第一次打包：約 3-5 分鐘
- 之後打包：約 1-2 分鐘

### 檔案大小
- EXE 檔案會比較大（15-20 MB）
- 因為包含了 Python 解釋器和所有套件
- 但同事使用更方便

### 防毒軟體
- 有些防毒軟體可能會誤報
- 這是正常現象（PyInstaller 打包的程式常見問題）
- 可以加入白名單

---

## 🔍 進階選項

### 加入圖示

```bash
pyinstaller --onefile --windowed --icon=icon.ico --name "TMflow_Modbus_Testkit" tmflow_modbus_testkit.py
```

### 隱藏 Import 警告

```bash
pyinstaller --onefile --windowed --name "TMflow_Modbus_Testkit" --hidden-import=pymodbus tmflow_modbus_testkit.py
```

### 減小檔案大小

```bash
pyinstaller --onefile --windowed --name "TMflow_Modbus_Testkit" --exclude-module matplotlib --exclude-module numpy tmflow_modbus_testkit.py
```

---

## 📝 建議的分享方式

### 給一般使用者（同事）
✅ **使用 EXE 版本**
- 不需要安裝任何東西
- 雙擊就能用
- 檔案較大但方便

### 給開發者
✅ **使用原始碼版本**
- 可以修改程式碼
- 檔案較小
- 需要 Python 環境

### 給測試人員
✅ **兩個版本都提供**
- EXE 版本用於快速測試
- 原始碼版本用於深入測試

---

## 🆘 常見問題

### Q: 打包失敗？
A: 確認已安裝所有依賴：
```bash
pip install -r requirements.txt
pip install pyinstaller
```

### Q: EXE 無法執行？
A: 
1. 檢查防毒軟體是否阻擋
2. 確認是在 Windows 上執行
3. 嘗試以系統管理員身分執行

### Q: 檔案太大？
A: 這是正常的，因為包含了：
- Python 解釋器
- pymodbus 套件
- tkinter 套件
- 其他依賴

### Q: 可以在其他電腦執行嗎？
A: 可以！這就是打包的目的：
- ✅ 不需要安裝 Python
- ✅ 不需要安裝套件
- ✅ 直接執行

---

## 🎉 總結

**推薦給同事使用 EXE 版本**：
1. 雙擊「打包成EXE.bat」
2. 等待完成
3. 分享 `TMflow_Modbus_Testkit_Portable_v1.0.1.0001.zip`
4. 同事解壓縮後直接執行 EXE

**簡單、方便、不需要任何安裝！** ✨
