# TMflow Modbus 測試工具 - v1.0.2.0003 更新說明

## 🎉 新功能

### 1. 📦 測試套件功能
- **批次執行多個測試**：一鍵執行預定義的測試組合
- **內建測試套件**：
  - 基本功能測試（Robot Link + Base 座標 + Joint 角度）
  - 完整座標測試（Base + Tool + Joint）
  - 狀態檢查（Robot 狀態）
  - User Define 測試
  - 全功能測試（所有項目）
- **查看套件內容**：執行前可預覽測試項目
- **測試結果統計**：自動統計通過/失敗數量

### 2. 🔖 IP 歷史記錄
- **自動記住常用 IP**：最多保存 10 個最近使用的 IP 位址
- **下拉選單快速選擇**：不用每次手動輸入
- **自動儲存設定**：連線成功後自動記錄
- **智慧排序**：最近使用的 IP 排在最前面

### 3. ⌨️ 鍵盤快捷鍵
提升操作效率，支援以下快捷鍵：
- **Ctrl+C**：連線/斷線
- **Ctrl+T**：執行全部測試
- **F5**：執行全部測試
- **Ctrl+L**：清除日誌
- **Ctrl+S**：儲存日誌
- **Esc**：停止性能測試

### 4. 📊 CSV 匯出功能
- **匯出測試結果**：將測試日誌匯出為 CSV 格式
- **Excel 相容**：使用 UTF-8 BOM 編碼，Excel 可直接開啟
- **結構化資料**：包含時間、測試項目、狀態、詳細資訊
- **自訂檔名**：支援自訂儲存位置和檔名

### 5. 💡 改進的錯誤提示
- **更詳細的錯誤訊息**：連線失敗時提供檢查清單
- **解決建議**：針對常見問題提供解決方案
- **友善的提示**：使用者更容易理解問題所在

### 6. 💾 設定檔自動儲存
- **自動記憶設定**：IP、Port 等設定自動儲存
- **下次啟動自動載入**：不用重複設定
- **設定檔位置**：`testkit_config.json`

## 🔧 改進項目

### 使用者體驗
- 按鈕文字加入快捷鍵提示（如：連線 (Ctrl+C)）
- IP 輸入改為下拉選單，支援歷史記錄
- 測試套件功能讓批次測試更方便
- 錯誤訊息更清楚，包含解決建議

### 功能增強
- 新增 CSV 匯出功能，方便製作測試報告
- 測試套件自動統計結果
- 支援鍵盤快捷鍵操作

### 穩定性
- 改進錯誤處理機制
- 設定檔自動備份

## 📖 使用說明

### 測試套件使用方式

1. **選擇測試套件**
   - 在「測試套件」區域選擇想要執行的套件
   - 點擊「查看內容」可預覽包含哪些測試項目

2. **執行測試套件**
   - 點擊「執行套件」按鈕
   - 工具會自動依序執行所有測試項目
   - 完成後顯示統計結果

3. **查看結果**
   - 測試過程會即時顯示在日誌區域
   - 最後會顯示通過/失敗統計

### IP 歷史記錄使用方式

1. **首次連線**
   - 輸入 IP 位址並連線
   - 連線成功後自動記錄到歷史

2. **使用歷史記錄**
   - 點擊 IP 欄位的下拉箭頭
   - 選擇之前使用過的 IP
   - 點擊連線

3. **管理歷史記錄**
   - 最多保存 10 個 IP
   - 最近使用的排在最前面
   - 可手動編輯 `testkit_config.json` 清除記錄

### 鍵盤快捷鍵

| 快捷鍵 | 功能 |
|--------|------|
| Ctrl+C | 連線/斷線 |
| Ctrl+T | 執行全部測試 |
| F5 | 執行全部測試 |
| Ctrl+L | 清除日誌 |
| Ctrl+S | 儲存日誌 |
| Esc | 停止性能測試 |

### CSV 匯出使用方式

1. **執行測試**
   - 先執行一些測試，產生測試日誌

2. **匯出 CSV**
   - 點擊「匯出 CSV」按鈕
   - 選擇儲存位置和檔名
   - 點擊儲存

3. **開啟 CSV**
   - 使用 Excel 或其他試算表軟體開啟
   - 可進一步編輯或製作報告

## 🔄 升級方式

### 方式 1：直接替換（推薦）
1. 備份舊版本的 `tmflow_modbus_testkit.py`
2. 下載新版本檔案
3. 替換舊檔案
4. 執行測試工具

### 方式 2：從 GitHub 更新
```bash
git pull origin main
```

### 方式 3：重新打包 EXE
如果使用 EXE 版本：
```bash
# 執行打包腳本
打包成EXE.bat

# 或手動打包
pyinstaller --onefile --windowed --name "TMflow_Modbus_Testkit" tmflow_modbus_testkit.py
copy dist\TMflow_Modbus_Testkit.exe Release\
```

## 📝 注意事項

1. **設定檔位置**
   - 新版本會在程式目錄建立 `testkit_config.json`
   - 此檔案記錄 IP 歷史和設定
   - 可以手動編輯或刪除

2. **相容性**
   - 完全相容舊版本的測試功能
   - 新增功能不影響原有操作
   - 可以無縫升級

3. **效能**
   - 測試套件執行時會有 0.3 秒間隔
   - 避免過快的請求影響 TMflow
   - 可在程式碼中調整間隔時間

## 🐛 已知問題

目前沒有已知問題。如發現問題請回報。

## 🔮 未來計畫

- [ ] 測試結果比對功能（預期值 vs 實際值）
- [ ] 自定義測試套件編輯器
- [ ] 測試報告自動生成（PDF/HTML）
- [ ] 測試腳本錄製功能
- [ ] 多語言支援（英文/繁中/簡中）

## 📞 問題回報

如有問題或建議，請透過 GitHub Issues 回報：
https://github.com/kenshu528-oss/Modbus-testkit-for-TMflow/issues

---

**更新日期**：2026-02-11  
**版本**：v1.0.2.0003  
**作者**：kenshu528
